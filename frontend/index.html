<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>MVP Desk - Login</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<header>
   <img src="MVPDESK.png" alt="Logo do Sistema">
</header>
<div class="container">
  <section class="login-box">
    <h2>Login</h2>
    <input type="email" id="email" placeholder="E-mail" required>
    <input type="password" id="senha" placeholder="Senha" required>
    <button onclick="acessar()">Entrar</button>
  </section>
</div>

<script>
async function acessar() {
  const email = document.getElementById("email").value;
  const senha = document.getElementById("senha").value;

  try {
    const resp = await fetch("http://localhost:3000/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, senha })
    });

    const data = await resp.json();

    if (data.success) {
      sessionStorage.setItem("usuario", JSON.stringify(data.user)); // ✅ agora sessionStorage
      if (data.user.Perfil === "Colaborador") {
        window.location.href = "colaborador.html";
      } else if (data.user.Perfil === "Técnico") {
        window.location.href = "tecnico.html";
      } else {
        alert("Perfil não autorizado.");
      }
    } else {
      alert(data.message);
    }
  } catch (err) {
    alert("Erro ao conectar com o servidor.");
    console.error(err);
  }
}
</script>
</body>
</html>
